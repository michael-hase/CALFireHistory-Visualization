<!DOCTYPE html>
<html>
<head>
    <title>Interactive Fire Data Visualization with Basemap</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
    integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
    integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
    crossorigin=""></script>
    <script src="https://raw.githubusercontent.com/michael-hase/hase-datavisualization-final.github.io/main/D3/d3.v7.js"></script>
    <style>
        #map {
            width: 100%;
            height: 600px; /* Adjust the height as needed */
        }
        .year-selector {
            margin: 10px;
        }
    </style>
</head>
<body>
    <!-- Leaflet map container -->
    <div id="map"></div>

    <!-- Year selector dropdown -->
    <div class="year-selector">
        <label for="year-select">Select Year:</label>
        <select id="year-select"></select>
    </div>

    <script>
        // Initialize the Leaflet map
        var map = L.map('map').setView([37.3, -120], 6);

        // Add a tile to the Leaflet map
        L.tileLayer(
            'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a>',
                maxZoom: 18,
            }).addTo(map);

        var width = 960, height = 600;

        var svg = d3.select(map.getPanes().overlayPane).append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g").attr("class", "leaflet-zoom-hide");

        // Define projection
        var projection = d3.geoMercator()
            .scale(1300)
            .center([-120, 37]) // Center on California
            .translate([width / 2, height / 2]);

        var path = d3.geoPath().projection(projection);

        // Variables to store data
        var yearData; // Store GeoJSON data for all years
        var selectedYear = ""; // Store the currently selected year

        // Load GeoJSON data for all years
        d3.json("https://raw.githubusercontent.com/michael-hase/hase-datavisualization-final.github.io/12105b46f22bca58c9f98987ea400916830db726/data/calfire.geojson").then(function (data) {
            yearData = data;
            populateYearSelector();
            updateMap();
        });

        // Populate the year selector dropdown
        function populateYearSelector() {
            var years = Array.from(new Set(yearData.features.map(feature => feature.properties.YEAR_))); // Change "YEAR" to "YEAR_"
            var yearSelect = d3.select("#year-select"); // Correct the selector

            yearSelect
                .selectAll("option")
                .data(years)
                .enter()
                .append("option")
                .text(d => d)
                .attr("value", d => d);

            yearSelect.on("change", function () {
                selectedYear = this.value;
                updateMap();
            });
        }

        // Update the map based on the selected year
        function updateMap() {
            var filteredFeatures = yearData.features.filter(feature => feature.properties.YEAR_ === selectedYear); // Change "YEAR" to "YEAR_"

            // Remove existing features
            g.selectAll("path").remove();

            // Add new features
            g.selectAll("path")
                .data(filteredFeatures)
                .enter()
                .append("path")
                .attr("d", path)
                .style("fill", "red")
                .style("stroke", "white")
                .style("stroke-width", "1px")
                .on("mouseover", function (event, d) {
                    // Add interactivity, like showing a tooltip
                })
                .on("mouseout", function (event, d) {
                    // Hide tooltip or reverse any hover effects
                });
        }
    </script>
</body>
</html>

    
    




